{% extends "_base.html" %}

{% block title %}キーワード管理 - フォーム管理{% endblock %}

{% block content %}
{% if current_user.is_authenticated %}
<div class="user-greeting">
    <p>こんにちは、<strong>{{ current_user.id }}</strong> さん！</p>
</div>
{% endif %}

<h1>🏷️ キーワード管理</h1>

<form method="post" class="keyword-form">
    <input type="text" name="keyword" placeholder="新しいキーワードを入力..." required>
    <button type="submit">➕ 追加</button>
</form>

<table>
    <thead>
        <tr>
            <th>キーワード</th>
            <th>状態</th>
            <th>操作</th>
        </tr>
    </thead>
    <tbody>
        {% for kw in keywords %}
        <tr>
            <td>
                <form method="post" action="/keywords/update/{{ kw.keyword }}">
                    <input type="text" name="new_keyword" value="{{ kw.keyword }}">
                    <button type="submit">✏️ 変更</button>
                </form>
            </td>
            <td>
                {% if kw.active %}
                    <span class="status-active">✅ 有効</span>
                {% else %}
                    <span class="status-inactive">❌ 無効</span>
                {% endif %}
            </td>
            <td>
                <div class="keyword-actions">
                    <a href="/keywords/toggle/{{ kw.keyword }}">
                        {% if kw.active %}🔄 無効にする{% else %}🔄 有効にする{% endif %}
                    </a>
                    <a href="/keywords/only/{{ kw.keyword }}" 
                       onclick="return confirm('「{{ kw.keyword }}」のみを有効にして、他を無効にしますか？');">
                        🎯 これだけ有効
                    </a>
                    <a href="/keywords/delete/{{ kw.keyword }}" 
                       onclick="return confirm('「{{ kw.keyword }}」を削除しますか？この操作は取り消せません。');">
                        🗑️ 削除
                    </a>
                </div>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% if not keywords %}
<div>
    <p>🏷️ キーワードがまだ登録されていません</p>
    <p>上のフォームから新しいキーワードを追加してください。</p>
</div>
{% endif %}

<div>
    <h3>💡 使い方のヒント</h3>
    <ul>
        <li><strong>キーワード追加:</strong> 検索に使用したいキーワードを入力して追加ボタンを押します。<br>※空白のみのキーワードは登録できません
        <li><strong>状態切り替え:</strong> キーワードの有効/無効を個別に切り替えできます。</li>
        <li><strong>これだけ有効:</strong> 選択したキーワードのみを有効にし、他を全て無効にします。</li>
        <li><strong>キーワード編集:</strong> 既存のキーワードの内容を変更できます。</li>
        <li>
          <strong>入力ルール:</strong> 法人属性、地域、業種 をスペース区切りで入力してください。
          <br><br>
          <strong>入力例：</strong>
          <ul>
            <li>医療法人 町田市 美容</li>
            <li>NPO法人 八王子市 介護</li>
            <li>株式会社 渋谷区 IT</li>
            <li>合同会社 横浜市 飲食</li>
            <li>有限会社 新宿区 建設</li>
          </ul>
          ※ 固定キーワード（<code>概要 情報</code>）と除外ワード（<code>-一覧 -ランキング -まとめ -比較</code>）は自動で追加されます。
        </li>
      </ul>     
</div>
{% endblock %}